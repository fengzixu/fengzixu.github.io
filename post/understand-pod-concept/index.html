
<!DOCTYPE html>
<html lang="en" data-figures="" class="page">
  <head>
<title>The smallest schedulable unit in Kubernetes — Pod | Littledriver&#39;s Blog</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script async src="https://www.googletagmanager.com/gtag/js?id=XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'XXXXXXXXXX');
</script>

<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="Overview As I have mentioned in the previous blog, lots of technologies the Kubernetes relies on are created with the help of the operating system. For example, …">
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@Haier0715">
<meta name="twitter:title" content="The smallest schedulable unit in Kubernetes — Pod" />
<meta property="og:url" content="https://littledriver.me/post/understand-pod-concept/" />
<meta property="og:title" content="The smallest schedulable unit in Kubernetes — Pod" />
<meta property="og:description" content="Overview As I have mentioned in the previous blog, lots of technologies the Kubernetes relies on are created with the help of the operating system. For example, …" />
<meta property="og:image" content="https://littledriver.me/images/thumbnail.png" />

<link rel="apple-touch-icon" sizes="180x180" href="https://littledriver.me/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://littledriver.me/icons/favicon-32x32.png">
<link rel="manifest" href="https://littledriver.me/icons/site.webmanifest">

<link rel="canonical" href="https://littledriver.me/post/understand-pod-concept/">

    

    
    
    <link rel="preload" href="https://littledriver.me/css/styles.01869c76e4757810d94ecbdccadba853d9d01d9416dfeb113df02e1479ff8b36e284e8bfeb3e8f353f2fdcdcbbdfcf27e558dbda96eb6341bfc304d55cd9e986.css" integrity = "sha512-AYacduR1eBDZTsvcytuoU9nQHZQW3&#43;sRPfAuFHn/izbihOi/6z6PNT8v3Ny7388n5Vjb2pbrY0G/wwTVXNnphg==" as="style" crossorigin="anonymous">
    <link rel="preload" href="https://littledriver.me/js/bundle.min.061d04727b51b0a8fafe2f15b9370a961f33306e7af52abd00d69c906f5d825f1599306159d7756d7d2b4f359767a170625ae541d1f37d05c1daa4d5c7feec25.js" as="script" integrity=
    "sha512-Bh0EcntRsKj6/i8VuTcKlh8zMG569Sq9ANackG9dgl8VmTBhWdd1bX0rTzWXZ6FwYlrlQdHzfQXB2qTVx/7sJQ==" crossorigin="anonymous">

    
    <link rel="stylesheet" type="text/css" href="https://littledriver.me/css/styles.01869c76e4757810d94ecbdccadba853d9d01d9416dfeb113df02e1479ff8b36e284e8bfeb3e8f353f2fdcdcbbdfcf27e558dbda96eb6341bfc304d55cd9e986.css" integrity="sha512-AYacduR1eBDZTsvcytuoU9nQHZQW3&#43;sRPfAuFHn/izbihOi/6z6PNT8v3Ny7388n5Vjb2pbrY0G/wwTVXNnphg==" crossorigin="anonymous">
    
  </head>
  
  
    
  
  <body data-code="7" data-lines="false" id="documentTop">

<header class="nav_header" >
  <nav class="nav"><a href='https://littledriver.me/' class="nav_brand nav_item" title="Littledriver&#39;s Blog">Littledriver&#39;s Blog
  <div class="nav_close">
    <div><svg class="icon">
  <use xlink:href="#open-menu"></use>
</svg><svg class="icon">
  <use xlink:href="#closeme"></use>
</svg></div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

  <div class="nav_parent">
    <a href="https://littledriver.me/" class="nav_item" title="Home">Home </a>
  </div>
  <div class="nav_parent">
    <a href="https://littledriver.me/about/" class="nav_item" title="About">About </a>
  </div>
      
<div class='follow'>
    
    
  <a href="https://github.com/fengzixu">
    <svg class="icon">
  <use xlink:href="#github"></use>
</svg>
  </a>
    
    
  <a href="https://twitter.com/@Haier0715">
    <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
  </a>
    
    
    
  <a href="https://littledriver.me/index.xml">
    <svg class="icon">
  <use xlink:href="#rss"></use>
</svg>
  </a>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">The smallest schedulable unit in Kubernetes — Pod</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <use xlink:href="#calendar"></use>
</svg></span>
    <span class="post_date">
      Dec 1, 2019</span>
    <span class="post_time"> · 11 min read</span><span>&nbsp;· <a href='https://littledriver.me/tags/container' title="container" class="post_tag button button_translucent">container
        </a><a href='https://littledriver.me/tags/kubernetes' title="kubernetes" class="post_tag button button_translucent">kubernetes
        </a>
    </span>
    <span class="page_only">&nbsp;·
  <div class="post_share">
    Share on:
    <a href="https://twitter.com/intent/tweet?text=The%20smallest%20schedulable%20unit%20in%20Kubernetes%20%e2%80%94%20Pod&url=https%3a%2f%2flittledriver.me%2fpost%2funderstand-pod-concept%2f&tw_p=tweetbutton" class="twitter" title="Share on Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#twitter"></use>
</svg>
    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2flittledriver.me%2fpost%2funderstand-pod-concept%2f&t=The%20smallest%20schedulable%20unit%20in%20Kubernetes%20%e2%80%94%20Pod" class="facebook" title="Share on Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#facebook"></use>
</svg>
    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="Share on LinkedIn" rel="nofollow">
      <svg class="icon">
  <use xlink:href="#linkedin"></use>
</svg>
    </a>
    <a href="https://littledriver.me/post/understand-pod-concept/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <use xlink:href="#copy"></use>
</svg>
    </a>
  </div>
  </span>
  </div>




    
    <div class="post_toc">
      <h2>Overview</h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#why-we-need-the-pod-containers-group-in-kubernetes">Why we need the Pod (containers group) in Kubernetes</a></li>
    <li><a href="#how-to-implement-the-pod-in-kubernetes-">How to implement the <code>Pod</code> in Kubernetes ?</a>
      <ul>
        <li><a href="#for-scheduling-strategy">For scheduling strategy</a></li>
        <li><a href="#for-container-design-pattern">For container design pattern</a></li>
        <li><a href="#implement-the-pod-by-ourselves">Implement the Pod by ourselves</a></li>
      </ul>
    </li>
    <li><a href="#summarize">Summarize</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
    </div>
    
    <div class="post_body"><h2 id="overview">Overview</h2>
<p>As I have mentioned in the previous blog,  lots of technologies the Kubernetes relies on are created with the help of the operating system. For example, the container is the specific process that corporates with the CGroup and Linux Namespace on OS. However, there is another essential OS concept used in Kubernetes: process group. It means one process group includes several processes. Those kinds of processes have a super affinity relationship. The <code>process group</code> is implemented as the <code>pod</code> in the Kubernetes.
Besides, the CGroup and Linux Namespace can supply the service for a process group initially.</p>
<h2 id="why-we-need-the-pod-containers-group-in-kubernetes">Why we need the Pod (containers group) in Kubernetes</h2>
<p>You can imagine the scenario of scheduling multiple processes that belong to the same group.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>// Group foo
<span class="ln"> 2</span>// There is a special requirement of scheduling processes:
<span class="ln"> 3</span>// A and B have to be scheduled into the same node.
<span class="ln"> 4</span>Process A -- 10CPU
<span class="ln"> 5</span>Process B -- 10CPU
<span class="ln"> 6</span>Process C -- 5 CPU
<span class="ln"> 7</span>
<span class="ln"> 8</span>// Node
<span class="ln"> 9</span>Node A -- 15 CPU
<span class="ln">10</span>Node B -- 20 CPU
</code></pre></div><p>If the <code>Process A</code> and <code>Process C</code> were scheduled into the <code>Node A</code>, firstly,  the scheduler doesn’t know how to schedule the <code>Process B</code>. Because the CPU resource almost is consumed by <code>Process A</code> and <code>Process C</code>  and the scheduling rule requires the <code>Process A</code> and <code>Process B</code> must run on the same node. That is a significant problem. Our scheduler seems to pick up a lousy scheduling strategy.</p>
<p>The root cause of the situation as above is the scheduler schedules processes belong to the same group separately. There is a super affinity relationship between <code>Process A</code> and <code>Process B</code>. We should handle them as a whole. So if you use the <code>container</code> instead of the <code>Process</code>, the same problem also happens in the Kubernetes world.</p>
<p>Util now, I think we can create a new scheduling strategy to solve this problem. It is unnecessary to create a new special content in kubernetes. If you also has the same confusion with me, let’s go back to the <code>Process</code> in the operating system.</p>
<p>When I perform the <code>pstree -g</code> command in my development VM, I captured the part of the result as below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="ln"> 1</span>├-nvim(163523)─┬─gopls(163556)─┬─{gopls}(163556)
<span class="ln"> 2</span>    │          ├─{gopls}(163556)
<span class="ln"> 3</span>    │          ├─{gopls}(163556)
<span class="ln"> 4</span>    │          ├─{gopls}(163556)
<span class="ln"> 5</span>    │          ├─{gopls}(163556)
<span class="ln"> 6</span>    │          └─{gopls}(163556)
<span class="ln"> 7</span>    ├─node(163533)─┬─gopls(163533)─┬─{gopls}(163533)
<span class="ln"> 8</span>    │     │        ├─{gopls}(163533)
<span class="ln"> 9</span>    │     │        ├─{gopls}(163533)
<span class="ln">10</span>    │     │        └─{gopls}(163533)
<span class="ln">11</span>    │     ├─{node}(163533)
<span class="ln">12</span>    │     ├─{node}(163533)
<span class="ln">13</span>    │     └─{node}(163533)
<span class="ln">14</span>    └─{nvim}(163523)
</code></pre></div><p>You can detect that there are so many processes corporate together to support the <code>nvim</code> work well.  And the process also needs multiple threads to corporate. The different processes (threads) play in different roles. But their target is the same:  finish all tasks when this process was performed in OS.</p>
<p>Although the docker community advises that developers should make the <code>single container pattern</code> as a development standard during containerizing applications. We cannot implement a production-level service within one binary file. It must include many containers, and they need to corporate together to serve customers.  So, how to handle the affinity relationship among multiple containers and obey the container development pattern at the same time? The answer is: <code>Pod</code></p>
<p><code>Pod</code> is a good proposal; it solves two problems as above: scheduling strategy and handling the affinity relationship.  <code>Pod</code> is a logic concept in Kubernetes.</p>
<h2 id="how-to-implement-the-pod-in-kubernetes-">How to implement the <code>Pod</code> in Kubernetes ?</h2>
<h3 id="for-scheduling-strategy">For scheduling strategy</h3>
<p>For the scheduling strategy of <code>Pod</code>,  the Kubernetes define a pod template that includes many fields to organize multiple containers. Every container can specify its own resource requests and limits for computing resources. That means the requirement of computing resources of the <code>Pod</code> is the sum of requirements of containers.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="ln"> 1</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="ln"> 2</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span><span class="ln"> 3</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="ln"> 4</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">frontend</span><span class="w">
</span><span class="ln"> 5</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="ln"> 6</span><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="ln"> 7</span><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="ln"> 8</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span><span class="ln"> 9</span><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="ln">10</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">MYSQL_ROOT_PASSWORD</span><span class="w">
</span><span class="ln">11</span><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;password&#34;</span><span class="w">
</span><span class="ln">12</span><span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="ln">13</span><span class="w">      </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="ln">14</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;64Mi&#34;</span><span class="w">
</span><span class="ln">15</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;250m&#34;</span><span class="w">
</span><span class="ln">16</span><span class="w">      </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span><span class="ln">17</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;128Mi&#34;</span><span class="w">
</span><span class="ln">18</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;500m&#34;</span><span class="w">
</span><span class="ln">19</span><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">wp</span><span class="w">
</span><span class="ln">20</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">wordpress</span><span class="w">
</span><span class="ln">21</span><span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="ln">22</span><span class="w">      </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="ln">23</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;64Mi&#34;</span><span class="w">
</span><span class="ln">24</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;250m&#34;</span><span class="w">
</span><span class="ln">25</span><span class="w">      </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span><span class="ln">26</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;128Mi&#34;</span><span class="w">
</span><span class="ln">27</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;500m&#34;</span><span class="w">
</span><span class="ln">28</span><span class="w">
</span></code></pre></div><h3 id="for-container-design-pattern">For container design pattern</h3>
<p>The container design pattern usually means multiple containers need to share some resources for the corporation so that they can serve to users well. So, the first problem we need to solve is creating an environment that can let multiple containers share network, volume, etc. A direct thought is implementing it in the docker level.  We can specify the volume or network parameters when the container is started.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>docker run mysql --volume-from<span class="o">=</span>web-server --network-from<span class="o">=</span>web-server
</code></pre></div><p>If we implement it as above, that means the <code>web-server</code> container needs to be started earlier than <code>mysql</code>. It breaks the equal relationship among containers that belong to the same pod. So we need to create another container.  It should be the first to be started. We call it <code>infra container</code> .</p>
<h4 id="infra-container">Infra container</h4>
<h5 id="principle">Principle</h5>
<p>I draw the graph to help us understand the infra-container.</p>
<p>







<div class="notices warning image-warning">
  <div class="label">Image not found</div>
    <style>
      a.warning-link {
        color: inherit !important;
        font-weight: inherit !important;
        text-decoration: underline !important;
        border-bottom: none !important; }
    </style>
    <p>Web path: <a href='http://o6sfmikvw.bkt.clouddn.com/729CEF17-3EB5-4DD9-BDA6-FD8D927E6A9E.png' title='Open this web path in a new tab' target='_blank' class='warning-link'>http://o6sfmikvw.bkt.clouddn.com/729CEF17-3EB5-4DD9-BDA6-FD8D927E6A9E.png</a></p>
    <p>Disk path: /static/http://o6sfmikvw.bkt.clouddn.com/729CEF17-3EB5-4DD9-BDA6-FD8D927E6A9E.png</p>
    <p>Using <a href='https://gohugo.io/content-management/page-bundles/' title='Information about Hugo Page Bundles' target='_blank' class='warning-link'>Page Bundles</a>: false</p>
</div>

</p>
<p>Containers within the pod usually share the volume and network resources. For the network resource, infra-container creates its own Linux Network namespace firstly. The MySQL and web-server containers are added into the same Network Namespace when they were created. That means they can use the <code>localhost</code> to communicate with each other. If you can understand Mount Namespace and infra-container. You must know that the volume is implemented in the pod level (infra-container level). That means we can mount any volume into the infra-container. If the MySQL and web-server can share the Mount Namespace with the infra-container, they can see the same volume directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="ln"> 1</span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">v1</span><span class="w">
</span><span class="ln"> 2</span><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Pod</span><span class="w">
</span><span class="ln"> 3</span><span class="w"></span><span class="nt">metadata</span><span class="p">:</span><span class="w">
</span><span class="ln"> 4</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">frontend</span><span class="w">
</span><span class="ln"> 5</span><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span><span class="ln"> 6</span><span class="w">  </span><span class="nt">Mounts</span><span class="p">:</span><span class="w">
</span><span class="ln"> 7</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">share-data</span><span class="w">
</span><span class="ln"> 8</span><span class="w">      </span><span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span><span class="ln"> 9</span><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/data</span><span class="w">
</span><span class="ln">10</span><span class="w">  </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span><span class="ln">11</span><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">db</span><span class="w">
</span><span class="ln">12</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span><span class="ln">13</span><span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span><span class="ln">14</span><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">share-data</span><span class="w">
</span><span class="ln">15</span><span class="w">        </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/data</span><span class="w">
</span><span class="ln">16</span><span class="w">    </span><span class="nt">env</span><span class="p">:</span><span class="w">
</span><span class="ln">17</span><span class="w">    </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">MYSQL_ROOT_PASSWORD</span><span class="w">
</span><span class="ln">18</span><span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;password&#34;</span><span class="w">
</span><span class="ln">19</span><span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="ln">20</span><span class="w">      </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="ln">21</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;64Mi&#34;</span><span class="w">
</span><span class="ln">22</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;250m&#34;</span><span class="w">
</span><span class="ln">23</span><span class="w">      </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span><span class="ln">24</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;128Mi&#34;</span><span class="w">
</span><span class="ln">25</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;500m&#34;</span><span class="w">
</span><span class="ln">26</span><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">wp</span><span class="w">
</span><span class="ln">27</span><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">wordpress</span><span class="w">
</span><span class="ln">28</span><span class="w">    </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span><span class="ln">29</span><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">share-data</span><span class="w">
</span><span class="ln">30</span><span class="w">        </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/data</span><span class="w">
</span><span class="ln">31</span><span class="w">    </span><span class="nt">resources</span><span class="p">:</span><span class="w">
</span><span class="ln">32</span><span class="w">      </span><span class="nt">requests</span><span class="p">:</span><span class="w">
</span><span class="ln">33</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;64Mi&#34;</span><span class="w">
</span><span class="ln">34</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;250m&#34;</span><span class="w">
</span><span class="ln">35</span><span class="w">      </span><span class="nt">limits</span><span class="p">:</span><span class="w">
</span><span class="ln">36</span><span class="w">        </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;128Mi&#34;</span><span class="w">
</span><span class="ln">37</span><span class="w">        </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;500m&#34;</span><span class="w">
</span><span class="ln">38</span><span class="w">
</span></code></pre></div><p>The example as above implement a volume directory on the host machine and mount it into the frontend pod. The volume directory can be seen by wordpress container and mysql container. Any container writes some data to the <code>/data</code> that can be shared with another container.</p>
<h5 id="implementation">Implementation</h5>
<p>If you try to run the command <code>docker ps</code>, you must see some containers that use the same image called <code>gcr.io/google_containers/pause</code></p>
<p>







<div class="notices warning image-warning">
  <div class="label">Image not found</div>
    <style>
      a.warning-link {
        color: inherit !important;
        font-weight: inherit !important;
        text-decoration: underline !important;
        border-bottom: none !important; }
    </style>
    <p>Web path: <a href='http://o6sfmikvw.bkt.clouddn.com/C55377DA-80EC-4730-86D5-FA0E5EB4D043.png' title='Open this web path in a new tab' target='_blank' class='warning-link'>http://o6sfmikvw.bkt.clouddn.com/C55377DA-80EC-4730-86D5-FA0E5EB4D043.png</a></p>
    <p>Disk path: /static/http://o6sfmikvw.bkt.clouddn.com/C55377DA-80EC-4730-86D5-FA0E5EB4D043.png</p>
    <p>Using <a href='https://gohugo.io/content-management/page-bundles/' title='Information about Hugo Page Bundles' target='_blank' class='warning-link'>Page Bundles</a>: false</p>
</div>

</p>
<p>The <code>pause</code> container’s lifecycle is the same as <code>pod</code>. The google company uses <code>pause</code> container to implement the concept of <code>infra-container</code>. You also can develop yours. <code>pause</code> container usually is responsible for two things:</p>
<ol>
<li>Creating a sharing environment for its children containers
1. Linux Namespace(e.g. Linux Network Namespace)
2. Volume</li>
<li>Enable the Linux PID Namespaces among containers group by the pod. So the <code>pause</code> container can be the super parent process to help us recycle orphan containers.</li>
</ol>
<p>Actually, you can use <code>unshare</code> command to create a process in new Linux Namespaces.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>sudo unshare --pid --uts --ipc --mount -f chroot rootfs /bin/sh
</code></pre></div><p>Because the child process usually inherits the Namespace from the parent process. If you use <code>unshare</code> command to create the new process, it creates its own Linux Namespace. It is too complicated to use original Linux commands to implement the <code>infra-container</code>.</p>
<p>Apart from the sharing Namespace and volume, the pause container plays an important role: the super parent process. It will be responsible for reaping the zombie processes.</p>
<blockquote>
<p>zombie process is a kind of child process which has already finished all tasks, but the process’s item stayed in <code>process table</code> of the OS kernel. That means the parent process doesn’t clean it though call the <code>wait</code> function.</p>
</blockquote>
<p>Actually, there are two reasons that can cause the zombie process:</p>
<ol>
<li>The parent process forgets to call the <code>wait</code> system call.</li>
<li>The parent process died before the child process, and the new parent process may don’t exist, or it doesn’t call the <code>wait</code>.</li>
</ol>
<p>For the first reason, I think we cannot resolve it. It depends on the developers. For the second reason, we can implement the <code>reaping</code> function on infra-container. Once their original parent process can not clean any child process run in the same pod, the super-parent process in infra-container recycles it. We need to enable PID namespace sharing among containers in the same pod for implementing this function.</p>
<p>Here is the source code of <code>pause</code> container by Google:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="ln"> 1</span><span class="cm">/*
</span><span class="ln"> 2</span><span class="cm">Copyright 2016 The Kubernetes Authors.
</span><span class="ln"> 3</span><span class="cm">Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
</span><span class="ln"> 4</span><span class="cm">you may not use this file except in compliance with the License.
</span><span class="ln"> 5</span><span class="cm">You may obtain a copy of the License at
</span><span class="ln"> 6</span><span class="cm">    http://www.apache.org/licenses/LICENSE-2.0
</span><span class="ln"> 7</span><span class="cm">Unless required by applicable law or agreed to in writing, software
</span><span class="ln"> 8</span><span class="cm">distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span><span class="ln"> 9</span><span class="cm">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</span><span class="ln">10</span><span class="cm">See the License for the specific language governing permissions and
</span><span class="ln">11</span><span class="cm">limitations under the License.
</span><span class="ln">12</span><span class="cm">*/</span>
<span class="ln">13</span>
<span class="ln">14</span><span class="cp">#include</span> <span class="cpf">&lt;signal.h&gt;</span><span class="cp">
</span><span class="ln">15</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="ln">16</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="ln">17</span><span class="cp">#include</span> <span class="cpf">&lt;sys/types.h&gt;</span><span class="cp">
</span><span class="ln">18</span><span class="cp">#include</span> <span class="cpf">&lt;sys/wait.h&gt;</span><span class="cp">
</span><span class="ln">19</span><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span><span class="ln">20</span><span class="cp"></span>
<span class="ln">21</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">sigdown</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">22</span>  <span class="n">psignal</span><span class="p">(</span><span class="n">signo</span><span class="p">,</span> <span class="s">&#34;Shutting down, got signal&#34;</span><span class="p">);</span>
<span class="ln">23</span>  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="ln">24</span><span class="p">}</span>
<span class="ln">25</span>
<span class="ln">26</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">sigreap</span><span class="p">(</span><span class="kt">int</span> <span class="n">signo</span><span class="p">)</span> <span class="p">{</span>
<span class="ln">27</span>  <span class="k">while</span> <span class="p">(</span><span class="n">waitpid</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">WNOHANG</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span>
<span class="ln">28</span><span class="p">}</span>
<span class="ln">29</span>
<span class="ln">30</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
<span class="ln">31</span>  <span class="k">if</span> <span class="p">(</span><span class="n">getpid</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
<span class="ln">32</span>    <span class="cm">/* Not an error because pause sees use outside of infra containers. */</span>
<span class="ln">33</span>    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Warning: pause should be the first process</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">34</span>
<span class="ln">35</span>  <span class="k">if</span> <span class="p">(</span><span class="n">sigaction</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigaction</span><span class="p">){.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">sigdown</span><span class="p">},</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="ln">36</span>    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="ln">37</span>  <span class="k">if</span> <span class="p">(</span><span class="n">sigaction</span><span class="p">(</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigaction</span><span class="p">){.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">sigdown</span><span class="p">},</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="ln">38</span>    <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
<span class="ln">39</span>  <span class="k">if</span> <span class="p">(</span><span class="n">sigaction</span><span class="p">(</span><span class="n">SIGCHLD</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="k">struct</span> <span class="n">sigaction</span><span class="p">){.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="n">sigreap</span><span class="p">,</span>
<span class="ln">40</span>                                             <span class="p">.</span><span class="n">sa_flags</span> <span class="o">=</span> <span class="n">SA_NOCLDSTOP</span><span class="p">},</span>
<span class="ln">41</span>                <span class="nb">NULL</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="ln">42</span>    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
<span class="ln">43</span>
<span class="ln">44</span>  <span class="k">for</span> <span class="p">(;;)</span>
<span class="ln">45</span>    <span class="n">pause</span><span class="p">();</span>
<span class="ln">46</span>  <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Error: infinite loop terminated</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
<span class="ln">47</span>  <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
<span class="ln">48</span><span class="p">}</span>
</code></pre></div><p>Through the example above, you can see that the pause will be the first(super parent) process of the Pod. If it catches the signal <code>SIGCHLD</code>, it calls <code>waited</code> to reap it. The most important is the pause process calls <code>pause</code> to wait signals during an infinity loop.</p>
<h4 id="init--container">Init  container</h4>
<p>In addition to the <code>infra-container</code>, there is another special container called <code>Init container</code>. It will be performed before others which are defined in spec.containers section of the pod. That means we can utilize this mechanism to do some preparations in advance, such as copy necessary files, performing the setting script, e.g.</p>
<p>Besides, if you want to do some works before the container starts or stops, you can use the lifecycle of container: <a href="https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/">Container Lifecycle Hooks - Kubernetes</a>.</p>
<h4 id="examples-of-container-design-pattern">Examples of container design pattern</h4>
<p>If you try to recall the solution of collecting the container logs, you can know that we use an another container design pattern <code>sidecar</code>.</p>
<p>







<div class="notices warning image-warning">
  <div class="label">Image not found</div>
    <style>
      a.warning-link {
        color: inherit !important;
        font-weight: inherit !important;
        text-decoration: underline !important;
        border-bottom: none !important; }
    </style>
    <p>Web path: <a href='http://o6sfmikvw.bkt.clouddn.com/logging-with-sidecar-agent.png' title='Open this web path in a new tab' target='_blank' class='warning-link'>http://o6sfmikvw.bkt.clouddn.com/logging-with-sidecar-agent.png</a></p>
    <p>Disk path: /static/http://o6sfmikvw.bkt.clouddn.com/logging-with-sidecar-agent.png</p>
    <p>Using <a href='https://gohugo.io/content-management/page-bundles/' title='Information about Hugo Page Bundles' target='_blank' class='warning-link'>Page Bundles</a>: false</p>
</div>

</p>
<p>We deploy a logging-agent container within the pod as a sidecar container, and it shares the same volume called <code>logging</code> with app-container. In the default situation,  the container outputs logs into the stdout. We can use the logging SDK in our service, and it output the logs into a file that stay in the persistent volume shared by logging-agent. The logging-agent can forward logs into remote logging service, such as elastic-search. Although, we cannot see logs of the container through <code>kubectl logs</code>. We can find another approach to resolve it: <a href="https://github.com/phusion/baseimage-docker">GitHub - phusion/baseimage-docker: A minimal Ubuntu base image modified for Docker-friendliness</a>. There is a logging service that was included in the base image, syslog-ng. It can help us redirect logs from the file too stdout. Generally, I prefer to find or develop a convenient base image with a small size for my services.</p>
<h3 id="implement-the-pod-by-ourselves">Implement the Pod by ourselves</h3>
<p>Let’s create the fake <code>pod</code> with the help of <code>pause</code> container.
First of all, we can run a pause container:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>docker run -d --name pause -p 8080:80 gcr.io/google_containers/pause-amd64:3.0
</code></pre></div><p>Then, we can run a blog application that shares resources with the <code>pause</code> container.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>docker run -d --name ghost --net<span class="o">=</span>container:pause --ipc<span class="o">=</span>container:pause --pid<span class="o">=</span>container:pause ghost
</code></pre></div><p>When we run the command <code>docker inspect &lt;ghost_container_id&gt;</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln"> 1</span>        <span class="s2">&#34;Config&#34;</span>: <span class="o">{</span>
<span class="ln"> 2</span>            <span class="s2">&#34;Hostname&#34;</span>: <span class="s2">&#34;52784ef438f9&#34;</span>,
<span class="ln"> 3</span>            <span class="s2">&#34;Domainname&#34;</span>: <span class="s2">&#34;&#34;</span>,
<span class="ln"> 4</span>            <span class="s2">&#34;User&#34;</span>: <span class="s2">&#34;&#34;</span>,
<span class="ln"> 5</span>            <span class="s2">&#34;AttachStdin&#34;</span>: false,
<span class="ln"> 6</span>            <span class="s2">&#34;AttachStdout&#34;</span>: false,
<span class="ln"> 7</span>            <span class="s2">&#34;AttachStderr&#34;</span>: false,
<span class="ln"> 8</span>            <span class="s2">&#34;ExposedPorts&#34;</span>: <span class="o">{</span>
<span class="ln"> 9</span>                <span class="s2">&#34;2368/tcp&#34;</span>: <span class="o">{}</span>
<span class="ln">10</span>            <span class="o">}</span>,
<span class="ln">11</span>            <span class="s2">&#34;Tty&#34;</span>: false,
<span class="ln">12</span>            <span class="s2">&#34;OpenStdin&#34;</span>: false,
<span class="ln">13</span>            <span class="s2">&#34;StdinOnce&#34;</span>: false,
<span class="ln">14</span>            <span class="s2">&#34;Env&#34;</span>: <span class="o">[</span>
<span class="ln">15</span>                <span class="s2">&#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span>,
<span class="ln">16</span>                <span class="s2">&#34;NODE_VERSION=10.17.0&#34;</span>,
<span class="ln">17</span>                <span class="s2">&#34;YARN_VERSION=1.19.1&#34;</span>,
<span class="ln">18</span>                <span class="s2">&#34;GOSU_VERSION=1.10&#34;</span>,
<span class="ln">19</span>                <span class="s2">&#34;NODE_ENV=production&#34;</span>,
<span class="ln">20</span>                <span class="s2">&#34;GHOST_CLI_VERSION=1.13.1&#34;</span>,
<span class="ln">21</span>                <span class="s2">&#34;GHOST_INSTALL=/var/lib/ghost&#34;</span>,
<span class="ln">22</span>                <span class="s2">&#34;GHOST_CONTENT=/var/lib/ghost/content&#34;</span>,
<span class="ln">23</span>                <span class="s2">&#34;GHOST_VERSION=3.0.3&#34;</span>
</code></pre></div><p>That means we can access the blog through the 2368 port. But we want to run another nginx container within the same Linux Network Namespace of ghost container. It is a more straightforward approach to help us detect the <code>Sharing Network Namespace</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span>docker run -d --name nginx -v <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/nginx.conf:/etc/nginx/nginx.conf --net<span class="o">=</span>container:pause --ipc<span class="o">=</span>container:pause --pid<span class="o">=</span>container:pause nginx
</code></pre></div><p>The nginx config as below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="ln"> 1</span><span class="k">error_log</span> <span class="s">stderr</span><span class="p">;</span>
<span class="ln"> 2</span><span class="k">events</span> <span class="p">{</span> <span class="kn">worker_connections</span>  <span class="mi">1024</span><span class="p">;</span> <span class="p">}</span>
<span class="ln"> 3</span><span class="k">http</span> <span class="p">{</span>
<span class="ln"> 4</span>    <span class="kn">access_log</span> <span class="s">/dev/stdout</span> <span class="s">combined</span><span class="p">;</span>
<span class="ln"> 5</span>    <span class="kn">server</span> <span class="p">{</span>
<span class="ln"> 6</span>        <span class="kn">listen</span> <span class="mi">80</span> <span class="s">default_server</span><span class="p">;</span>
<span class="ln"> 7</span>        <span class="kn">server_name</span> <span class="s">example.com</span> <span class="s">www.example.com</span><span class="p">;</span>
<span class="ln"> 8</span>        <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
<span class="ln"> 9</span>            <span class="kn">proxy_pass</span> <span class="s">http://127.0.0.1:2368</span><span class="p">;</span>
<span class="ln">10</span>        <span class="p">}</span>
<span class="ln">11</span>    <span class="p">}</span>
<span class="ln">12</span><span class="p">}</span>
</code></pre></div><p>Now we can access the <code>http://localhost:8080</code> to access the ghost blog.</p>
<p>







<div class="notices warning image-warning">
  <div class="label">Image not found</div>
    <style>
      a.warning-link {
        color: inherit !important;
        font-weight: inherit !important;
        text-decoration: underline !important;
        border-bottom: none !important; }
    </style>
    <p>Web path: <a href='http://o6sfmikvw.bkt.clouddn.com/2D37EECB-3FE2-4329-B55A-F7B332771CE2.png' title='Open this web path in a new tab' target='_blank' class='warning-link'>http://o6sfmikvw.bkt.clouddn.com/2D37EECB-3FE2-4329-B55A-F7B332771CE2.png</a></p>
    <p>Disk path: /static/http://o6sfmikvw.bkt.clouddn.com/2D37EECB-3FE2-4329-B55A-F7B332771CE2.png</p>
    <p>Using <a href='https://gohugo.io/content-management/page-bundles/' title='Information about Hugo Page Bundles' target='_blank' class='warning-link'>Page Bundles</a>: false</p>
</div>

</p>
<p>There is a sharing topology among containers as above:</p>
<ol>
<li>Pause &lt;-&gt; Ghost</li>
<li>Pause &lt;—&gt; Nginx</li>
<li>Nginx &lt;—&gt; Ghost</li>
</ol>
<p>When you can see the home page of Ghost blog through accessing the port of Nginx server, those containers have shared the Linux Namespace.</p>
<p>







<div class="notices warning image-warning">
  <div class="label">Image not found</div>
    <style>
      a.warning-link {
        color: inherit !important;
        font-weight: inherit !important;
        text-decoration: underline !important;
        border-bottom: none !important; }
    </style>
    <p>Web path: <a href='http://o6sfmikvw.bkt.clouddn.com/pause_container.png' title='Open this web path in a new tab' target='_blank' class='warning-link'>http://o6sfmikvw.bkt.clouddn.com/pause_container.png</a></p>
    <p>Disk path: /static/http://o6sfmikvw.bkt.clouddn.com/pause_container.png</p>
    <p>Using <a href='https://gohugo.io/content-management/page-bundles/' title='Information about Hugo Page Bundles' target='_blank' class='warning-link'>Page Bundles</a>: false</p>
</div>

</p>
<p>Managing the lifetime and relationship of containers is too complex, so the kubernetes create <code>Pod</code> to help us do that.</p>
<h2 id="summarize">Summarize</h2>
<p>Finally, after you saw this blog, I want to tell you 3 things:</p>
<ol>
<li>It is better to understand any new concept of Kubernetes in the operating system perspective. Because the Kubernetes relies on lots of fundamental technologies of the operating system.</li>
<li>Even if the small and basic concept like <code>Pod</code>, there are many pieces of knowledge can be learned.</li>
<li>Don&rsquo;t learn too much about a particular concept, and knowledge has no end. Know what it is, why, and how it is enough.</li>
</ol>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://www.ianlewis.org/en/almighty-pause-container">The Almighty Pause Container - Ian Lewis</a></li>
</ul>

    </div>
<div class="post_comments">
  
  
</div>



  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
        <h2>Littledriver</h2>
      <div class="author_bio">
        Coder, Learner
      </div>
      <a href='https://littledriver.me/about/' class="button mt-1" role="button" title='Read More'>Read More</a>
    
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://littledriver.me/post/google-sre-reading-1/" class="nav-link" title="Understanding Reliability Risk">Understanding Reliability Risk</a>
      </li>
      <li>
        <a href="https://littledriver.me/post/how-kubernetes-deletes-a-reource-object/" class="nav-link" title="How Kubernetes Deletes A Pod Gracefully">How Kubernetes Deletes A Pod Gracefully</a>
      </li>
      <li>
        <a href="https://littledriver.me/post/papaer-node-for-mapreduce/" class="nav-link" title="Paper Note — MapReduce">Paper Note — MapReduce</a>
      </li>
      <li>
        <a href="https://littledriver.me/post/some-questions-about-layers-of-network-protocol/" class="nav-link" title="几个和网络分层有关的问题">几个和网络分层有关的问题</a>
      </li>
      <li>
        <a href="https://littledriver.me/post/understand-container-technology/" class="nav-link" title="Kubernetes 的基石 — 容器技术">Kubernetes 的基石 — 容器技术</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="categories-section">Categories</h2>
      <nav class="tags_nav">
        <a href='https://littledriver.me/categories/kubernetes/' class="post_tag button button_translucent" title="kubernetes">
          KUBERNETES
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://littledriver.me/categories/container/' class="post_tag button button_translucent" title="container">
          CONTAINER
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://littledriver.me/categories/troubleshooting/' class="post_tag button button_translucent" title="troubleshooting">
          TROUBLESHOOTING
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://littledriver.me/categories/distributed-system/' class="post_tag button button_translucent" title="distributed-system">
          DISTRIBUTED-SYSTEM
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/categories/network/' class="post_tag button button_translucent" title="network">
          NETWORK
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/categories/reliability/' class="post_tag button button_translucent" title="reliability">
          RELIABILITY
          <span class="button_tally">1</span>
        </a>
        
        
      </nav>
    </div>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://littledriver.me/tags/container/' class="post_tag button button_translucent" title="container">
          CONTAINER
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://littledriver.me/tags/kubernetes/' class="post_tag button button_translucent" title="kubernetes">
          KUBERNETES
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://littledriver.me/tags/index/' class="post_tag button button_translucent" title="index">
          INDEX
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/tags/kuberentes/' class="post_tag button button_translucent" title="kuberentes">
          KUBERENTES
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/tags/network/' class="post_tag button button_translucent" title="network">
          NETWORK
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/tags/paper-note/' class="post_tag button button_translucent" title="paper-note">
          PAPER-NOTE
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://littledriver.me/tags/sre/' class="post_tag button button_translucent" title="sre">
          SRE
          <span class="button_tally">1</span>
        </a>
        
        
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/> 
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="arrow">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
</svg>


<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://littledriver.me/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="Littledriver&#39;s Blog">
    <p>Copyright&nbsp;<span class="year"></span>&nbsp;LITTLEDRIVER&#39;S BLOG. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <use xlink:href="#arrow"></use>
</svg>
</a>

  </div>
</footer>

    <script type="text/javascript" src="https://littledriver.me/js/bundle.min.061d04727b51b0a8fafe2f15b9370a961f33306e7af52abd00d69c906f5d825f1599306159d7756d7d2b4f359767a170625ae541d1f37d05c1daa4d5c7feec25.js" integrity="sha512-Bh0EcntRsKj6/i8VuTcKlh8zMG569Sq9ANackG9dgl8VmTBhWdd1bX0rTzWXZ6FwYlrlQdHzfQXB2qTVx/7sJQ==" crossorigin="anonymous"></script>
    
  </body>
</html>
